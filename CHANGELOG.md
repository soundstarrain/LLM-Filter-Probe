# 更新日志

本项目的所有重要变更将在此记录。

---

## 1.1.0 (2025-12-08)

### 🚀 新功能

- **动态算法阈值配置**：在前端"高级设置"中开放了对 `algorithm_switch_threshold`（宏观/微观扫描切换阈值）的动态配置功能，允许用户根据需求在效率与精度之间进行微调。
  - 支持范围：20-100 字符
  - 默认值：35 字符
  - 实时验证：防止配置导致的死循环

- **扫描耗时记录**：在扫描完成时，系统现在会自动记录并输出本次扫描的总耗时。
  - 精确计时：从扫描开始到完成的完整耗时统计
  - 友好格式：支持秒级（如 3.45s）和分钟级（如 2m 57s）的自适应显示
  - 日志记录：耗时信息同时输出到系统日志，便于性能分析和监控

### ✨ 优化与改进

#### 核心参数统一管理
- **单一数据源**：将 `algorithm_switch_threshold` 的默认值全局统一为 `35`
  - `config/algorithm/default.json`：35
  - `config/settings/default.json`：35
  - `backend/core/constants.py`：从配置读取，后备值 35
  - `frontend/src/stores/rootStore.js`：默认 35
- **消除硬编码**：所有模块均从配置文件读取该阈值，实现了真正的单一数据源管理
- **向后兼容**：旧的常量 `HYBRID_HANDOVER_THRESHOLD` 和 `MICRO_SCAN_THRESHOLD` 保留为别名，确保旧代码逻辑不受影响

#### 前端体验与安全增强
- **死循环防护**：在高级设置界面加入了安全校验
  - 实时检验：`algorithm_switch_threshold > 2 × overlap_size`
  - 视觉反馈：显示当前值是否满足安全条件（✓ 安全 / ✗ 危险）
  - 操作保护：当验证失败时，禁用保存按钮并显示明确的警告提示
- **界面简化**：为提升用户体验，UI 上隐藏了低频参数（但后端与文档仍保留）
  - 隐藏参数：`jitter`、`token_limit`、`delimiter`、`min_granularity`
  - 保留能力：用户仍可通过编辑 JSON 配置文件来修改这些参数
- **参数联动**：前端加载/保存时自动处理参数合并，确保运行时覆盖生效

#### 代码架构优化
- **常量来源统一**：不再在多个地方硬编码 35
  - `BinarySearcher`：从 `algorithm_config` 读取阈值
  - `TextScanner`：合并 settings 中的 `algorithm_switch_threshold` 到 algorithm 配置
  - `HybridScanStrategy`：使用 `algorithm_config` 中的值或默认值
- **配置优先级**：运行时读取优先级为
  1. `settings.user.json` > 2. `settings.default.json` > 3. `constants` 后备值

---

## 1.0.1 (2025-12-07)

### ✨ 优化与修复

- **优化**：改进了“检测结果”弹窗的用户体验。
  - **分页功能**：为“完整检测结果”弹窗中的表格添加了分页功能，默认每页显示 10 条，并支持切换每页条数（10/20/50/100）。
  - **序号修正**：修复了分页后序号不连续的问题，现在序号会根据页码和每页条数动态计算。
  - **自动重置**：在进行关键词搜索或结果列表更新时，表格会自动重置到第一页，提升了操作的流畅性。


## 1.0.0 (2025-12-07)

**首次公开发布**

这是项目的第一个稳定版本，包含了完整的核心功能与标准化的文档。

### 核心功能

#### 🔍 扫描引擎
- **混合扫描算法**：自适应长/短文本处理，自动在二分查找和精确扫描之间切换
  - 短文本：使用精确扫描，确保 100% 精度
  - 长文本：使用二分查找，显著提升扫描速度
  - 自动切换阈值：根据文本长度智能选择算法
- **高效的二分查找**：采用重叠安全区设计，防止敏感词被分割
- **精确定位**：支持字符级别的敏感词定位（最小粒度可设为 1）

#### 🚀 性能优化
- **智能缓存机制**：实现"发现一次，全局屏蔽"策略，减少重复 API 调用
- **并发控制**：可配置的并发数（1-50），适应不同网络环境
- **自动重试机制**：支持指数退避和随机抖动，提高网络不稳定环境下的成功率
- **Token 优化**：智能分块处理，避免超出模型上下文限制

#### 🎨 用户界面
- **Vue 3 前端**：现代化的响应式界面，支持深色/浅色主题
- **实时反馈**：通过 WebSocket 实时推送扫描进度、日志与结果
- **文件拖拽**：支持直接拖拽文件进行扫描
- **结果导出**：支持导出扫描结果为 JSON 格式
- **预设管理**：内置多个预设方案，支持自定义预设

#### ⚙️ 配置系统
- **多层级配置**：系统默认 → 用户设置 → 预设 → 运行时覆盖
- **灵活的预设方案**：
  - `relay`：中转 API 预设（推荐）
  - `official`：官方 API 预设
  - `custom`：自定义预设
- **无需重启**：配置修改即时生效
- **敏感信息管理**：API 密钥单独存储，支持多个 API 配置

#### 🔧 后端架构
- **FastAPI 框架**：高性能异步 API 服务
- **模块化设计**：清晰的代码结构，易于扩展
- **完整的错误处理**：详细的日志和错误提示
- **WebSocket 支持**：实时双向通信，支持自动重连

### 技术亮点

- **内存高效**：流式处理大文件，避免一次性加载到内存
- **网络容错**：多重重试机制和超时控制，适应复杂网络环境
- **可观测性**：详细的日志记录和实时进度反馈
- **跨平台支持**：Windows/Linux/macOS 多平台支持


